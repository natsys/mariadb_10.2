create or replace table t(id int, val int, s date, e date,
                          period for p(s,e),
                          primary key(id, p without overlaps)) engine=myisam;

insert into t values (1, 1, '2003-01-01', '2003-03-01'),
                     (1, 2, '2003-05-01', '2003-07-01');

insert into t values (1, 3, '2003-01-01', '2003-04-01')
       on duplicate key update val=3;
select row_count();
select * from t;
insert into t values (1, 3, '2003-01-01', '2003-06-01')
       on duplicate key update val=4;
select row_count();
select * from t;

replace into t values(1, 5, '2003-01-01', '2003-06-01');
select row_count();
select * from t;

drop table t;

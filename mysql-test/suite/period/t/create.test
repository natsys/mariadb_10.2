create or replace table t (id int primary key, s date, e date,
                           period for mytime(s,e));
--echo # CONSTRAINT CHECK (s < e) is added implicitly, and shouldn't be shown
--echo # this is important for correct command-based replication
show create table t;
create or replace table t (id int primary key, s timestamp(6), e timestamp(6),
                           period for mytime(s,e));
show create table t;

--echo # SQL17 p. 832
--echo # 2) If a <table period definition> TPD is specified, then:
--echo # a) <table scope> shall not be specified.
--error ER_PERIOD_TEMPORARY_NOT_ALLOWED
create or replace temporary table t (s date, e date, period for mytime(s,e));

--echo # SQL17 p. 831
--echo # The <data type or domain name> contained in CD1 is either DATE or a
--echo # timestamp type and it is equivalent to the <data type or domain name>
--echo # contained in CD2.
--error ER_PERIOD_TYPES_MISMATCH
create or replace table t (id int primary key, s datetime, e date,
                           period for mytime(s,e));
--error ER_PERIOD_TYPES_MISMATCH
create or replace table t (s timestamp(2), e timestamp(6),
                           period for mytime(s,e));
--error ER_WRONG_FIELD_SPEC
create or replace table t (id int primary key, s int, e date,
                           period for mytime(s,e));
--error ER_PERIOD_FIELD_NOT_FOUND
create or replace table t (id int primary key, s date, e date,
                           period for mytime(s,x));
--error ER_PERIOD_MAX_COUNT_EXCEEDED
create or replace table t (id int primary key, s date, e date,
                           period for mytime(s,e),
                           period for mytime2(s,e));

--echo # SQL17 p. 831
--echo # No <column name> in any <column definition> shall be equivalent to PN.
--error ER_PERIOD_NAME_IS_NOT_ALLOWED_FOR_FIELD
create or replace table t (mytime int, s date, e date,
    period for mytime(s,e));

--echo # CD1 and CD2 both contain either an explicit or an implicit
--echo # <column constraint definition> that specifies
--echo # NOT NULL NOT DEFERRABLE ENFORCED.
--error ER_PERIOD_FIELD_WRONG_ATTRIBUTES
create or replace table t (id int primary key, s date NULL, e date,
                           period for mytime(s,e));

--echo # SQL17 p.832
--echo # Neither CD1 nor CD2 shall contain an <identity column specification>, a
--echo # <generation clause>, a <system time period start column specification>,
--echo #  or a <system time period end column specification>.
--error ER_PERIOD_FIELD_WRONG_ATTRIBUTES
create or replace table t (id int primary key,
                           s date,
                           e date generated always as (s+1),
                           period for mytime(s,e));

--error ER_PERIOD_FIELD_WRONG_ATTRIBUTES
create or replace table t (id int primary key,
                           s date,
                           e date as (s+1) VIRTUAL,
                           period for mytime(s,e));

--error ER_PERIOD_FIELD_WRONG_ATTRIBUTES
create or replace table t (id int primary key, s timestamp(6), e timestamp(6),
                           st timestamp(6) as row start,
                           en timestamp(6) as row end,
                           period for system_time (st, en),
                           period for mytime(st,e)) with system versioning;

--echo # SQL17 p.832
--echo # Let IDCN be an implementation-dependent <constraint name> that is not
--echo # equivalent to the <constraint name> of any table constraint descriptor
--echo # included in S.
create or replace table t (x int, s date, e date,
                           period for mytime(s, e),
                           constraint mytime check (x > 1));

--error ER_PERIOD_FIELD_ACCESS_BY_CONSTRAINT
create or replace table t(s date, e date, d date,
                          period for mytime(s, e),
                          constraint check (d < e or d > s));

create or replace database test;
